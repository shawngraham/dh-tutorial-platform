---
id: if-02
title: 'State and Memory: Tracking the Reader''s Journey'
moduleId: interactive-fiction
prerequisites:
  - if-01
estimatedTimeMinutes: 10
difficulty: beginner
learningObjectives:
  - Track reader state using a dictionary with inventory and flags
  - Use state to conditionally gate narrative paths
  - Connect state-tracking to ergodic literature concepts
keywords:
  - state
  - inventory
  - flags
  - ergodic literature
  - conditional branching
---

# State and Memory: Tracking the Reader's Journey

## Analogy

When you read a traditional novel, the book does not remember how you read it. But consider a scholar working through a physical archive: they carry a notebook, collect documents, and their access to restricted materials depends on credentials they have gathered. This is **state** — the accumulated context that shapes what a reader can do next. Espen Aarseth coined the term **ergodic literature** (from Greek *ergon* + *hodos*, "work" + "path") for texts requiring non-trivial effort to traverse. In interactive fiction, the reader's state — their inventory, their flags, their history — is what makes the traversal meaningful. The story remembers what you have done.

## Key Concepts

### The State Dictionary

We track the reader's current condition with a **state dictionary** — a plain Python dict holding items collected, flags set, and the current location:

:::definition
**State**: A dictionary that records the reader's accumulated context — items collected, flags triggered, locations visited — at any point during an interactive narrative.
:::

```python
state = {
    "inventory": [],
    "visited": [],
    "location": "entrance",
    "has_permission": False
}
```

### Modifying State Through Choices

When a reader takes an action, we update the state dictionary:

```python
# Reader picks up an item
state["inventory"].append("old photograph")
state["visited"].append("entrance")
state["location"] = "reading_room"
print(f"Collected: {state['inventory']}")
# Output: Collected: ['old photograph']
```

### Conditional Gating

The power of state is that it **gates** future paths. Some passages are only accessible if the reader has collected the right item or set the right flag:

:::definition
**Gating**: A design pattern where access to a narrative passage depends on the reader's current state — possessing an item, having visited a location, or having triggered a flag.
:::

```python
state = {"inventory": ["library card"], "location": "restricted_section"}

if "library card" in state["inventory"]:
    print("The librarian checks your card and grants you entry.")
else:
    print("You need a library card to enter this section.")
# Output: The librarian checks your card and grants you entry.
```

### Combining Story Structure with State

We can integrate state with the story dictionary from the previous lesson. Here, the story dict defines the narrative, and the state dict tracks the reader's journey:

```python
story = {
    "garden": {
        "text": "A walled garden with a stone bench. A brass key glints in the grass.",
        "choices": {"Take the key": "garden_key", "Go to the gate": "gate"}
    },
    "garden_key": {
        "text": "You pocket the brass key. The gate beckons to the north.",
        "choices": {"Go to the gate": "gate"}
    },
    "gate": {
        "text": "A locked iron gate blocks the path.",
        "choices": {}
    }
}

state = {"inventory": []}

# Step 1: visit garden, take the key
print(story["garden"]["text"])
state["inventory"].append("brass key")

# Step 2: go to gate, check for key
print(story["gate"]["text"])
if "brass key" in state["inventory"]:
    print("You unlock the gate with the brass key and step through.")
else:
    print("The gate is locked. You cannot pass.")
```

### Tracking Visited Locations

You can also track which passages have been visited, enabling "you have already been here" messages or unlocking new choices on repeat visits:

```python
state = {"visited": []}

location = "main_hall"
if location in state["visited"]:
    print("You recognize this hall from before.")
else:
    print("You enter the main hall for the first time.")
    state["visited"].append(location)
# Output: You enter the main hall for the first time.
```

## Practice

:::try-it
Create a state dictionary with an empty inventory and a `"has_map"` flag set to `False`. Simulate picking up a map (add `"map"` to inventory, set the flag to `True`), then write an `if` statement that prints different messages depending on whether the reader has the map.
:::

## Transfer

In digital humanities research, state-tracking models how readers or users navigate complex information spaces. Archivists model researcher workflows: what credentials are needed, what collections have been accessed, what permissions unlock further materials. Historians could build counterfactual simulations ("What if this treaty had been signed?") by using flags and conditions to gate alternative timelines (but do look up 'agent based modeling'). The state dictionary is a simple but powerful tool for modeling any process where past actions constrain future possibilities.

:::challenge
Simulate a 3-step exploration of a spooky archive. In step 1, the reader picks up a rusty key. In step 2, they encounter a locked door. In step 3, the key unlocks a hidden collection. Print each passage and the final inventory.
:::

---challenges---

### Challenge: The Archive Key

- id: if-02-c1
- language: python
- difficulty: beginner

#### Starter Code

```python
state = {"inventory": [], "location": "entrance"}

# Step 1: entrance — find and collect a rusty key
passage_1 = "You enter the old archive. A rusty key lies on the front desk."
# YOUR CODE: add "rusty key" to inventory, update location to "reading_room", print passage_1

# Step 2: reading room — see a locked door
passage_2 = "The reading room is filled with fragile documents. A locked door stands to the north."
# YOUR CODE: update location to "locked_door", print passage_2

# Step 3: locked door — use key if you have it
# YOUR CODE: check if "rusty key" is in inventory
#   if yes: set passage_3 to the success message
#   if no: set passage_3 to the failure message
# print passage_3
# print the inventory

```

#### Expected Output

```
You enter the old archive. A rusty key lies on the front desk.
The reading room is filled with fragile documents. A locked door stands to the north.
You use the rusty key. The door opens to reveal a hidden collection of rare manuscripts!
Inventory: ['rusty key']
```

#### Hints

1. Use `state["inventory"].append("rusty key")` to add the key.
2. Use `if "rusty key" in state["inventory"]:` to check whether you collected it.
3. Print the inventory with `print("Inventory:", state["inventory"])`.

#### Solution

```python
state = {"inventory": [], "location": "entrance"}

# Step 1: entrance — pick up a rusty key
passage_1 = "You enter the old archive. A rusty key lies on the front desk."
state["inventory"].append("rusty key")
state["location"] = "reading_room"
print(passage_1)

# Step 2: reading room — see a locked door
passage_2 = "The reading room is filled with fragile documents. A locked door stands to the north."
state["location"] = "locked_door"
print(passage_2)

# Step 3: locked door — use key if available
if "rusty key" in state["inventory"]:
    passage_3 = "You use the rusty key. The door opens to reveal a hidden collection of rare manuscripts!"
else:
    passage_3 = "The door is locked. You cannot proceed without a key."
print(passage_3)
print("Inventory:", state["inventory"])
```

